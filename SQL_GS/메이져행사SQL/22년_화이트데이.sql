With MothQy as (
    select 
        a11.DATECD,
        a13.RGNNM,
        -- max(SUBSTR(a13.STORENM,1,INSTR(a13.STORENM,'(')-1 ))  STORENM,
        -- max('V'||SUBSTR(a13.STORENM,INSTR(a13.STORENM,'(')+1, -( INSTR(a13.STORENM,'(') -INSTR(a13.STORENM,':'))-1))  CustCol_31,
        a11.GOODCD  GOODCD,
        max(trim(trailing from a12.GOODNM))  GOODNM,
        max(a12.GOOD_CLS1NM)  GOOD_CLS1NM,
        max(a12.GOOD_CLS2NM)  GOOD_CLS2NM,
        max(a12.GOOD_CLS3NM)  GOOD_CLS3NM,
        a12.GOOD_CLS1CD  GOOD_CLS1CD,
        a12.GOOD_CLS2CD  GOOD_CLS2CD,
        a12.GOOD_CLS3CD  GOOD_CLS3CD,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량,
		sum(a11.stk_qty)  재고수량
    from LGMJVDP.TB_STK_FT a11
        JOIN LGMJVDP.TB_GOOD_DM a12
        on (a11.GOODCD = a12.GOODCD)
        JOIN LGMJVDP.TB_STORE_DM a13
        on (a11.STORECD = a13.STORECD)
    where a11.DATECD BETWEEN '2022-03-01' and '2022-03-16'
    AND a13.RGNCD BETWEEN ('41') and ('60')
    AND (a12.GOOD_CLS3CD in ('53032127','54012134','54052140','55022151','56012164','56032166','77032786')
    OR a12.GOOD_CLS1CD in ('90')
    OR a12.GOOD_CLS2CD in ('5201')
    OR (a12.GOOD_CLS2CD in ('5502','5501','5601') AND a12.GOOD_CLS3CD not in ('55022151','56012163','56012164'))
    OR a11.GOODCD in ('8009280006759', '8009280006766', '8437000014218', '5601069112595', '8809297198016', '8809297198122', '8809297198139', '8809297198146', '8809297198153', '8809297198160', '8809297198023', '8809297198177', '8809297198184', '8809297198191', '8809297198207', '8809297198214', '8809297198030', '8809297198221', '8809297198238', '8809297198245', '8809297198252', '8809297198047', '8809297198269', '8809297198276', '8809297198054', '8809297198283', '8809297198290', '8809297198061', '8809297198306', '8809297198313', '8809297198320', '8809297198009', '8809297198078', '8809297198344', '8809297198085', '8809297198092', '8809297198108', '8809297198115', '8809311977528', '8809311977535', '8809311974138', '8809311974145', '8809297198375', '8809297198368', '8809347870527', '8809337630025', '8809347870237', '8809347870213', '8809177894014', '8809282300066', '82184090480', '5099873005101', '5099873046173', '5099873060711', '8809447911786', '8809447911793', '8809447911809', '8809470122043', '8809470122067', '8809264726693', '8809264727331', '8809264727348', '8809264727317', '8809264727355', '2800064902795', '2800064901972', '2800064903037', '2800064903013', '2800064902740', '8809308679466', '8809308679473', '8809432252153', '8809432252818', '2800032810077', '2800032810084', '2800063812422', '2800063812439', '8809290406019', '8805123005534', '2800071911100', '8805123005541', '8809311491109', '8809311491116', '8805123005794', '8805123005800', '8809328951825', '8809328951849', '8809328951832', '8801051340273', '8801051340297', '8801051348934', '8809369780774', '8801051214826', '8801051281729', '8809495036714', '4058222100103', '8809442485060', '8809442485077', '8809442485091', '8809442485084', '2860036900006', '8805123006197', '8805123006203', '8805123006210', '8809056002950', '8809056002929', '8809056002936', '8809587990153', '8809587990160', '8809587990139', '8809587990146', '8809587990122', '8809542560681', '8809542560261', '8809542560254', '8809066906613', '8809616742173', '2800100035913', '2800100035920', '2800100035937', '2800100035395', '2800100035944', '2800100036026', '2800100036033', '8809616742159', '8809587990115', '2800100146213', '2800100146541', '2800100146558', '2800100146565', '2800100146572', '2800100146589', '2800100146596', '2800100146602', '2800100146619', '2800100146626', '2800100146633', '2800100146640', '2800100146657', '2800100146664', '2800100146671', '2800100145247', '2800100145254', '2800100145261', '2800100145278', '2800100145285', '2800100145292', '2800100145308', '2800100145315', '2800100145322', '2800100145339', '2800100145346', '2800100145353', '2800100145360', '2800100145377', '2800100145384', '2800100145391', '2800100145407', '2800100145414', '2800100145421', '2800100145438', '2800100145445', '2800100145452', '8801043062183', '8801047114857', '8801047114864', '8801047181903', '8801052076980', '8804874549519', '8809394830567', '8801068101850', '8801019313219', '8801055770564', '8801111614344', '8801037092332', '80765486', '8801019316555')
        )
    GROUP by
    	a13.RGNNM,
        a11.DATECD,
        a11.GOODCD,
        a12.GOOD_CLS1CD,
        a12.GOOD_CLS2CD,
        a12.GOOD_CLS3CD
)
    select
    '캔디/젤리' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOOD_CLS2CD in ('5502','5501') AND GOOD_CLS3CD not in ('55022151','56012163')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM

    Union

    select
    '바' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOOD_CLS3CD in ('56012160')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM
    
    Union

    select
    '쉘' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOOD_CLS3CD in ('56012159')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM
    
    Union

    select
    '세트' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where MothQy.GOOD_CLS3CD in ('56012164','56032166') OR MothQy.GOODCD in ('8809286494365','8718469320950','8809678521440','8809678521464','4037719657290','9555030108505','4000512992509','8801062334100','6942836711054','6942836712839','8801062334087','8804973306471','8804973306488','8809744800097','8809290406804','8801906169196','3481291016258','3481291016265','3481291016272')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM

    Union

    select
    '봉제인형' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOOD_CLS3CD in ('77032786')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM

    Union

    select
    '완구' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOODCD in ('8809297198016','8809297198122','8809297198139','8809297198146','8809297198153','8809297198160','8809297198023','8809297198177','8809297198184','8809297198191','8809297198207','8809297198214','8809297198030','8809297198221','8809297198238','8809297198245','8809297198252','8809297198047','8809297198269','8809297198276','8809297198054','8809297198283','8809297198290','8809297198061','8809297198306','8809297198313','8809297198320','8809297198009','8809297198078','8809297198344','8809297198085','8809297198092','8809297198108','8809297198115','8809311977528','8809311977535','8809311974138','8809311974145','8809297198375','8809297198368','8809347870527','8809337630025','8809347870237','8809347870213','8809177894014','8809282300066')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM

    Union

    select
    '와인' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOOD_CLS1CD in ('90') OR GOOD_CLS2CD in ('5201')  
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM

    Union

    select
    '기타파격' as Name,
    RGNNM,
    DATECD,
    GOODCD,
    GOODNM,
    GOOD_CLS1NM,
    GOOD_CLS2NM,
    GOOD_CLS3NM,
    sum(매출액) 매출액,
    sum(판매수량) 판매수량,
    sum(재고수량) 재고수량
    from MothQy
    where GOODCD in ('7896451912480','8806002015828','8809389601134','8809389601158','9555030107614','8809390650787','8809390650770','8886049310124','9002975319003','8801128280884','8801128280020','5411011822027','5411011822010','4001686301555','4001686375754','5012035901738','8691216095557','8691216096370','4001686323366','4001686381328','5996379377360','8691216096134','4902775018982','8697465217924','028400012072','028400065863','8801073311220','8801062247431','8801062516858','9001372003607','8801111186582','8801111186117','8809247974394','8809247974400','8801019307652','8801019307133','8710508771082','8710508771099','077330500142','9000331604275','9000331605210','8804973304842','8804973304811','5201360148332','4018077632006','4018077632297','8804973304828','8804973304835','8801062017188','8809447911786','8809447911793','8809447911809','8809470122043','8809470122067','8809264726693','8809264727331','8809264727348','8809264727317','8809264727355','2800064902795','2800064901972','2800064903037','2800064903013','2800064902740','8801051925616','8809308679466','8809308679473','8809432252153','8809432252818','2800032810077','2800032810084','2800063812422','2800063812439','8809290406019','2800071911094','8805123005534','2800071911100','8805123005541','8809311491109','8809311491116','8805123005794','8805123005800','8809328951825','8809328951849','8809328951832','8801051340273','8801051340297','8801051348934','8809369780774','8801051214826','8801051281729','8809587990016','8809587990023','8809587990030','8809495036714','4058222100103','8809442485060','8809442485077','8809442485091','8809442485084','2860036900006','8805123006197','8805123006203','8805123006210','8809056002950','8809056002929','8809056002936','8809587990153','8809587990160','8809587990139','8809587990146','8809587990122','8809542560681','8809542560261','8809542560254','8809066906613','8809616742173','2800100035913','2800100035920','2800100035937','2800100035395','2800100036026','2800100036033','8809587990115')
    group by 
    RGNNM, DATECD, GOODCD, GOODNM, GOOD_CLS1NM, GOOD_CLS2NM, GOOD_CLS3NM



