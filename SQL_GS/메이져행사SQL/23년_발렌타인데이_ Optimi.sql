

------------------------------------/* 4부문)3지역 STORECD와 CLS & GOODCD 상세 데이터 추출하기 (230226) */
  select
        a12.GOOD_CLS3NM as Name,

        CASE WHEN a12.GOOD_CLS3CD in ('56012159', '56012160', '56012161', '77032786', '56012162') then a12.GOOD_CLS3NM
             WHEN  /*세트*/a12.GOOD_CLS3CD in ('56012164','56032166') or a11.GOODCD in ('8809898130378', '8809898130361', '8809318028766', '8809318028773', '8809318028780', '8809318028797', '8809318028896', '8809318028902', '8809318028919', '8809318028940', '8809318028957', '8809318028735', '8809318028742', '8809318028964', '8809318028971', '8809318029008', '8809318029015', '8809318029022', '8809318029039', '8809318028995', '9555030108932', '8410740905794', '5601069112601', '5601069111543', '8809389602483', '8803747118593', '8803747118708', '8803747118586', '8803747118364', '8809406956254', '8809406956162', '8809406956247', '8809406956360', '8809406956193', '8809406956230', '8809406956339', '8809406956278', '8809649057527', '8809649053895', '8809649057510') THEN '세트'
             WHEN  /*완구*/a11.GOODCD in ('8809297198016', '8809297198122', '8809297198139', '8809297198146', '8809297198153', '8809297198160', '8809297198023', '8809297198177', '8809297198184', '8809297198191', '8809297198207', '8809297198214', '8809297198030', '8809297198221', '8809297198238', '8809297198245', '8809297198252', '8809297198047', '8809297198269', '8809297198276', '8809297198054', '8809297198283', '8809297198290', '8809297198061', '8809297198306', '8809297198313', '8809297198320', '8809297198009', '8809297198078', '8809297198344', '8809297198085', '8809297198092', '8809297198108', '8809297198115', '8809311977528', '8809311977535', '8809311974138', '8809311974145', '8809297198375', '8809297198368', '8809347870527', '8809337630025', '8809347870237', '8809347870213', '8809177894014', '8809282300066') THEN '완구'
             WHEN  /*와인*/a12.GOOD_CLS1CD in ('90') OR a12.GOOD_CLS2CD in ('5201')  OR a11.GOODCD in ('082184090480', '5099873005101', '5099873226230', '5099873046173', '5099873060711', '9013100061063', '2800100195396', '8809861950026', '2800100196027', '8809613590890', '8809613590869', '8809613590876', '8809613590883') THEN '와인'
             WHEN  /*기타파격*/ a11.GOODCD in ('8801019611537', '8801117365905', '8801052076980', '8691720004946', '8691720004939', '8691720004977', '8691720004960', '8801055770564', '8809415436631', '8809415436655', '8809415436679', '8809240930250', '6921211116660', '8809318026380', '4895230503508', '8809632252939', '8809318028315', '8809788010735', '8803420903522', '8803420903652', '4895230503652', '6971162150787', '8809402811007', '8809402811014', '8809648261086', '8809648261062', '8809399462541', '8809394878682', '8809527080319', '8809788010414', '8809788010506', '8809788010629', '5200701005747', '5200701005891', '8809396294176', '8809841060578', '6910289043671', '8809841060431', '8809841060592', '8809827250771', '8809827250788', '8809827250795', '8809827250801', '8809827250818', '8809827250825', '8809827250832', '8809827250849', '4902750448186', '4902750434646', '49432978', '4902750444331', '4902750666832', '4902750444478', '4902750444645', '4902750627222', '4902750633155', '4901326043275', '4901326043282', '8691216095939', '4001686372586', '4001686372975', '4001686301555', '4001686323366', '4001686375754', '5012035901738', '8426617002473', '8691216095557', '8691216096134', '8691216099074', '8691216099135', '8691216099579', '8691216101661', '4901550270553', '4902555106410', '8809288634110', '8809288634127', '8809288634134', '8804973304811', '8804973304828', '8804973304835', '8804973304842', '8804973307959', '8801019009594', '8801019005909') THEN '기타파격'
             ELSE '분류불가' END 구분,

        a11.DATECD,
        a13.RGNNM,
        a13.TEAM_LN,
        a13.PART_LN,
        max(SUBSTR(a13.STORENM,1,INSTR(a13.STORENM,'(')-1 ))  STORENM,
        a13.STORECD,
        a11.GOODCD  GOODCD,
        max(trim(trailing from a12.GOODNM))  GOODNM,
        a12.GOOD_CLS1CD  GOOD_CLS1CD,
        max(a12.GOOD_CLS1NM)  GOOD_CLS1NM,  
        a12.GOOD_CLS2CD  GOOD_CLS2CD,
        max(a12.GOOD_CLS2NM)  GOOD_CLS2NM,
        a12.GOOD_CLS3CD  GOOD_CLS3CD,
        max(a12.GOOD_CLS3NM)  GOOD_CLS3NM,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량,
		sum(a11.stk_qty)  재고수량
        from	LGMJVDP.TB_STK_FT	a11
            join	LGMJVDP.TB_GOOD_DM	a12
            on 	(a11.GOODCD = a12.GOODCD)
            join	LGMJVDP.TB_STORE_DM	a13
            on 	(a11.STORECD = a13.STORECD)
        where	(a11.DATECD between '2023-02-01' and '2023-02-16' or a11.DATECD between '2022-02-01' and '2022-02-16')
        and a13.RGNCD in ('54')
        and (/*봉제인형+판바쉘*/(a12.GOOD_CLS3CD in ('56012159', '56012160', '56012161', '77032786','56012162'))
            OR  /*세트*/(a12.GOOD_CLS3CD in ('56012164','56032166') or a11.GOODCD in ('8809898130378', '8809898130361', '8809318028766', '8809318028773', '8809318028780', '8809318028797', '8809318028896', '8809318028902', '8809318028919', '8809318028940', '8809318028957', '8809318028735', '8809318028742', '8809318028964', '8809318028971', '8809318029008', '8809318029015', '8809318029022', '8809318029039', '8809318028995', '9555030108932', '8410740905794', '5601069112601', '5601069111543', '8809389602483', '8803747118593', '8803747118708', '8803747118586', '8803747118364', '8809406956254', '8809406956162', '8809406956247', '8809406956360', '8809406956193', '8809406956230', '8809406956339', '8809406956278', '8809649057527', '8809649053895', '8809649057510'))
            OR  /*완구*/(a11.GOODCD in ('8809297198016', '8809297198122', '8809297198139', '8809297198146', '8809297198153', '8809297198160', '8809297198023', '8809297198177', '8809297198184', '8809297198191', '8809297198207', '8809297198214', '8809297198030', '8809297198221', '8809297198238', '8809297198245', '8809297198252', '8809297198047', '8809297198269', '8809297198276', '8809297198054', '8809297198283', '8809297198290', '8809297198061', '8809297198306', '8809297198313', '8809297198320', '8809297198009', '8809297198078', '8809297198344', '8809297198085', '8809297198092', '8809297198108', '8809297198115', '8809311977528', '8809311977535', '8809311974138', '8809311974145', '8809297198375', '8809297198368', '8809347870527', '8809337630025', '8809347870237', '8809347870213', '8809177894014', '8809282300066'))
            OR  /*와인*/        (a12.GOOD_CLS1CD in ('90')
                        OR a12.GOOD_CLS2CD in ('5201') 
                        OR a11.GOODCD in ('082184090480', '5099873005101', '5099873226230', '5099873046173', '5099873060711', '9013100061063', '2800100195396', '8809861950026', '2800100196027', '8809613590890', '8809613590869', '8809613590876', '8809613590883'))
            OR  /*기타파격*/        (a11.GOODCD in ('8801019611537', '8801117365905', '8801052076980', '8691720004946', '8691720004939', '8691720004977', '8691720004960', '8801055770564', '8809415436631', '8809415436655', '8809415436679', '8809240930250', '6921211116660', '8809318026380', '4895230503508', '8809632252939', '8809318028315', '8809788010735', '8803420903522', '8803420903652', '4895230503652', '6971162150787', '8809402811007', '8809402811014', '8809648261086', '8809648261062', '8809399462541', '8809394878682', '8809527080319', '8809788010414', '8809788010506', '8809788010629', '5200701005747', '5200701005891', '8809396294176', '8809841060578', '6910289043671', '8809841060431', '8809841060592', '8809827250771', '8809827250788', '8809827250795', '8809827250801', '8809827250818', '8809827250825', '8809827250832', '8809827250849', '4902750448186', '4902750434646', '49432978', '4902750444331', '4902750666832', '4902750444478', '4902750444645', '4902750627222', '4902750633155', '4901326043275', '4901326043282', '8691216095939', '4001686372586', '4001686372975', '4001686301555', '4001686323366', '4001686375754', '5012035901738', '8426617002473', '8691216095557', '8691216096134', '8691216099074', '8691216099135', '8691216099579', '8691216101661', '4901550270553', '4902555106410', '8809288634110', '8809288634127', '8809288634134', '8804973304811', '8804973304828', '8804973304835', '8804973304842', '8804973307959', '8801019009594', '8801019005909')))

        group by	a12.GOOD_CLS3NM,
            a13.RGNNM,
            a13.STORECD,
            a13.PART_LN,
            a13.TEAM_LN,
            a11.DATECD,
            a11.GOODCD,
            a12.GOOD_CLS1CD,
            a12.GOOD_CLS2CD,
            a12.GOOD_CLS3CD
