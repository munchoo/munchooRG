    select	
        '일반' as 분류,
        a11.STORECD  STORECD,
        max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
from	LGMJVDP.TB_STK_FT	a11
        join	LGMJVDP.TB_DATE_DM	a12
        on 	(a11.DATECD = a12.DATECD)
        join	LGMJVDP.TB_GOOD_DM	a13
        on 	(a11.GOODCD = a13.GOODCD)
        join	LGMJVDP.TB_STORE_DM	a14
        on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
    or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
    and a14.RGNCD in ('30')
    and a11.GOODCD in ('8801062012701', '8801062012725', '8801062883646', '8801062012756', '8801062012732', '8801062870806', '8801062874378', '8801062870820', '8801019314001', '8801019309946', '8801019311345', '8801019310928', '8801019314872', '8801019314803', '8801019314797', '8009280006766', '8009280006759')
    group by	a11.STORECD,
    a12.YMCD,
    a11.DATECD
    

        union

    select	'완구' as 분류,
        a11.STORECD  STORECD,
        max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
 from	LGMJVDP.TB_STK_FT	a11
        join	LGMJVDP.TB_DATE_DM	a12
        on 	(a11.DATECD = a12.DATECD)
        join	LGMJVDP.TB_GOOD_DM	a13
        on 	(a11.GOODCD = a13.GOODCD)
        join	LGMJVDP.TB_STORE_DM	a14
        on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
    or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
    and a14.RGNCD in ('30')
    and a11.GOODCD in ('8809297198016', '8809297198122', '8809297198139' , '8809297198146' , '8809297198153' , '8809297198160' , '8809297198023' , '8809297198177' , '8809297198184' , '8809297198191' , '8809297198207' , '8809297198214' , '8809297198030' , '8809297198221' , '8809297198238' , '8809297198245' , '8809297198252' , '8809297198047' , '8809297198269' , '8809297198276' , '8809297198054' , '8809297198283' , '8809297198290' , '8809297198061' , '8809297198306' , '8809297198313' , '8809297198320' , '8809297198009' , '8809297198078' , '8809297198344' , '8809297198085' , '8809297198092' , '8809297198108' , '8809297198115' , '8809337630049' , '8809337630018' , '8809297198375' , '8809297198368' , '8809347872606' , '8809347870572' , '8809347870534' , '8807633127348' , '8809347870527' , '8809347870473' , '8809337630025' , '8809347870237' , '8809347870213' , '8809347870206' , '8809347870183' , '8809347870176' , '8809347872552' , '8809347870114' , '8809347870084' , '8809347870077' , '8809347870060' , '8809235600045' , '8809347870039' , '8809347870725' , '8809347870756' , '8809177894014' , '8809282300066' , '2800063813443' , '2800063211041' , '2800063211010' , '2800063211102' , '2800063211119' , '8809243724061' , '8809243721268' , '2800063220197' , '8809243790653' , '8809087955997' , '8809087956772' , '8809311977528' , '8809311977535' , '8809311974138' , '8809311974145' , '2800063812798' , '2800063812804' , '2800072220256' , '2800072220263' , '2800072220287' , '2800072220294' , '2800099993386' , '2800099993393' , '2800099993379' , '8809243720988' , '8809243720285' , '8809243721008' , '8804097645142' , '8804097622181' , '2800072220270' , '8809125813074' , '8809125815399' , '8809125817973' , '8809318023549' , '8809318024263' , '8809334824335' , '8809334826049' , '8809334826155' , '8809554560877' , '8809554560884' , '8809554565780')
    group by	a11.STORECD,
    a12.YMCD,
    a11.DATECD

    union

    select	
        '초콜렛' as 분류,
        a11.STORECD  STORECD,
        max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
from	LGMJVDP.TB_STK_FT	a11
        join	LGMJVDP.TB_DATE_DM	a12
        on 	(a11.DATECD = a12.DATECD)
        join	LGMJVDP.TB_GOOD_DM	a13
        on 	(a11.GOODCD = a13.GOODCD)
        join	LGMJVDP.TB_STORE_DM	a14
        on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
    or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
    and a14.RGNCD in ('30')
    and a11.GOODCD in ('80050278', '80135906', '8000500180723', '80050513', '80001249', '80001263', '80001270', '80818120', '8691720004960', '8691720004977', '8682077080004', '8801117120306', '8801019314742', '8801037093049', '8801037092332', '8886049310124', '8809415436631', '8809415436655', '8809415436679', '4000512005964', '6971824480146', '8992741984324', '6921211116660', '6921211104292', '8990800000053', '6921211115076', '8990800000992', '8801043057660', '8801043057639', '8809240930250', '8013399395154', '8013399347863', '4001686301555', '5012035901738', '4001686375754', '8691216095557', '4001686323366', '9002975319003', '8691216096370', '4001686381328', '8426617002473', '5996379377360', '8691216096134', '8691216098541', '8691216098794', '8691216099135', '8850338019715', '8850338019043', '8850338019036', '7610700008157', '7610700012420', '8803747117220', '8801117449803', '8809037840892', '76222276', '7622210704740', '9556001216144', '6294003599133', '9556001198839', '6294003593681', '3800020492895', '8801062642021', '8801062641895', '8801062641826', '6942836712228', '6942836721893', '6942836721879', '6942836721855', '6942836712242', '80974482', '80768258', '4800092660634', '80001072', '80001096', '80001089', '8809141471111', '8809141471128', '5900353621240', '8801111930314', '8801019208324', '8801043062183', '8801117760908', '8801111183062', '8809189924372', '8809720820521')
    group by	a11.STORECD,
    a12.YMCD,
    a11.DATECD

    union

    select
        '와인' as 분류,
    	a11.STORECD  STORECD,
    	max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
    from	LGMJVDP.TB_STK_FT	a11
        join	LGMJVDP.TB_DATE_DM	a12
        on 	(a11.DATECD = a12.DATECD)
        join	LGMJVDP.TB_GOOD_DM	a13
        on 	(a11.GOODCD = a13.GOODCD)
        join	LGMJVDP.TB_STORE_DM	a14
        on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
        or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))    
        and a14.RGNCD in ('30')
        and a13.GOOD_CLS2CD in ('5201')
    group by	
        a11.STORECD,
        a12.YMCD,
        a11.DATECD

    union

    select
        S.분류,
        S.STORECD,
    	S.STORENM,
    	S.CustCol_31,
        S.년도,
        S.DATECD,
        sum(S.재고원가) 재고원가,
        sum(S.재고수량) 재고수량,
        sum(S.매출액)  매출액,
        sum(S.판매수량)  판매수량
    from (
    select	
        '세트' as 분류,
        a11.STORECD  STORECD,
    	max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD  DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
    from	LGMJVDP.TB_STK_FT	a11
            join	LGMJVDP.TB_DATE_DM	a12
            on 	(a11.DATECD = a12.DATECD)
            join	LGMJVDP.TB_GOOD_DM	a13
            on 	(a11.GOODCD = a13.GOODCD)
            join	LGMJVDP.TB_STORE_DM	a14
            on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
        or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
        and a14.RGNCD in ('30')
        and a13.GOOD_CLS3CD in ('54012134', '55022151', '56012164')
        and a11.GOODCD not in ( '8000500005026', '8000500133170', '8000500003787', '8000500187166', '8000500331750', '8000500009673', '8000500178638', '8000500227671')

    group by a11.STORECD,
            a12.YMCD,
            a11.DATECD

    union

    select	
        '세트' as 분류,
        a11.STORECD  STORECD,
    	max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        '202111' as 년도,
        '2021-11-01' as DATECD,
        0 as 재고원가,
        0 as 재고수량,
        sum(a11.NTSAL_AMT)  매출액,
        sum(a11.SAL_QTY)  판매수량
    from	LGMJVDP.TB_STK_FT	a11
            join	LGMJVDP.TB_DATE_DM	a12
            on 	(a11.DATECD = a12.DATECD)
            join	LGMJVDP.TB_GOOD_DM	a13
            on 	(a11.GOODCD = a13.GOODCD)
            join	LGMJVDP.TB_STORE_DM	a14
            on 	(a11.STORECD = a14.STORECD)
    where	a12.YMCD in ('202110')
        and a14.RGNCD in ('30')
        and a11.GOODCD in ( '8801062869428', '8801062869411', '8801062869404', '8801062869398', '8809344669292', '8809344669308', '8809344669315', '8809344669322', '8809344669339')

    group by a11.STORECD,
            a12.YMCD,
            a11.DATECD
    )S
    group by S.분류,
        S.STORECD,
    	S.STORENM,
    	S.CustCol_31,
        S.년도,
        S.DATECD


    union

    select
        '봉제인형' as 분류,
        a11.STORECD  STORECD,
    	max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
        a12.YMCD 년도,
        a11.DATECD  DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
    	sum(a11.NTSAL_AMT)  매출액,
    	sum(a11.SAL_QTY)  판매수량
        from	LGMJVDP.TB_STK_FT	a11
        join	LGMJVDP.TB_DATE_DM	a12
        on 	(a11.DATECD = a12.DATECD)
        join	LGMJVDP.TB_GOOD_DM	a13
        on 	(a11.GOODCD = a13.GOODCD)
        join	LGMJVDP.TB_STORE_DM	a14
        on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
    or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
    and a14.RGNCD in ('30')
    and a13.GOOD_CLS3CD in ('77032786')
    group by	
    a11.STORECD,
    a12.YMCD,
    a11.DATECD

    union
    
    select	
        '기타' as 분류,
    	a11.STORECD  STORECD,
    	max(SUBSTR(a14.STORENM,1,INSTR(a14.STORENM,'(')-1 ))  STORENM,
    	max('V'||SUBSTR(a14.STORENM,INSTR(a14.STORENM,'(')+1, -( INSTR(a14.STORENM,'(') -INSTR(a14.STORENM,':'))-1))  CustCol_31,
    	a12.YMCD 년도,
        a11.DATECD  DATECD,
        sum(a11.STK_AMT) 재고원가,
        sum(a11.STK_QTY) 재고수량,
    	sum(a11.NTSAL_AMT)  매출액,
    	sum(a11.SAL_QTY)  판매수량
    from	LGMJVDP.TB_STK_FT	a11
	join	LGMJVDP.TB_DATE_DM	a12
	  on 	(a11.DATECD = a12.DATECD)
	join	LGMJVDP.TB_GOOD_DM	a13
	  on 	(a11.GOODCD = a13.GOODCD)
	join	LGMJVDP.TB_STORE_DM	a14
	  on 	(a11.STORECD = a14.STORECD)
    where	(a12.YMCD in ('202111')
    or a12.DATECD BETWEEN ('2020-11-01') and ('2020-11-16'))
    and a14.RGNCD in ('30')
    and (a11.GOODCD in ('8809442483271', '8809442483585', '8809442483684', '8809328951825', '8809328951849', '8809328951832', '8804097612175', '8804097612083', '8809318024249', '8809318024256', '8802395910351', '8802395910368', '8809179676861', '8805123005794', '8805123005800', '8809311491109', '8809311491116', '2800100025006', '8809616741626', '8809616741619', '8809542560711', '8809542560735', '8809542560698', '8809542560742', '8809542560704', '8809542560728', '8809542560261', '8809542560254', '8809056002929', '8809056002950', '8809056002936', '2800100023521', '2800100023491', '2800100023507', '2800100023514', '2800100014550', '2800100014567', '2800100014536', '2800100014543', '2800100006920', '2800100006913', '2800100006883', '2800100006890', '2800100006906', '2800100006876', '2800100006869', '2800100006852', '2800100005732', '2800100005718', '2800100005725', '2800100004209', '2800100002892', '2800100002908', '2800100002878', '2800100002885', '2800100002847', '2800100002854', '2800100002861', '2800100002823', '2800100002830', '2800099998909', '2800099998916', '2800099998879', '2800099998886', '2800099998893', '2800099998794', '2800099998862', '2800099998763', '2800099998770', '2800099998787', '2800099998749', '2800099998732', '2800099998756', '2800099998848', '8801062870585', '8801062628476', '8801062521999', '8801062875412', '8801062518258', '8801062518210', '8801062879090', '8801062521876', '8801062381937', '8801117352202', '8801117141301', '8801117268206', '8801111912082', '8801111912099', '8801111904292', '8801111916479', '8801019204951', '8801019609671', '8803747117299', '8809678521884', '8809678521877', '8801043062381', '8801043062411', '8801043062220', '8801043062220', '8801043062381', '8801043062411', '8803747117299', '8809678521877', '8809678521884')
    or a13.GOOD_CLS1CD in ('90'))
    group by
        a11.STORECD,
        a12.YMCD,
        a11.DATECD

    order by 1

